CXX = g++
CXXFLAGS = -std=c++17 -O2 -Wall

SRC_DIR = src
DATA_DIR = data

STANDARD_SRCS = $(SRC_DIR)/main.cpp
STANDARD_HEADERS = $(SRC_DIR)/state.h $(SRC_DIR)/sim_anneal.h
STANDARD_TARGET = sim_anneal

PARALLEL_SRCS = $(SRC_DIR)/main.cpp
PARALLEL_HEADERS = $(SRC_DIR)/state_parallel.h $(SRC_DIR)/sim_anneal.h
PARALLEL_TARGET = sim_anneal_parallel

all: $(STANDARD_TARGET) $(PARALLEL_TARGET)

$(STANDARD_TARGET): $(STANDARD_SRCS) $(STANDARD_HEADERS)
	$(CXX) $(CXXFLAGS) $(STANDARD_SRCS) -o $(STANDARD_TARGET)

$(PARALLEL_TARGET): $(PARALLEL_SRCS) $(PARALLEL_HEADERS)
	$(CXX) $(CXXFLAGS) -fopenmp $(PARALLEL_SRCS) -o $(PARALLEL_TARGET)

$(GENERATOR_TARGET): $(GENERATOR_SRC)
	$(CXX) $(CXXFLAGS) $(GENERATOR_SRC) -o $(GENERATOR_TARGET)

generate: 
	python generate_case.py 100000 0.998 921 100000 out.txt

run: 
	./$(STANDARD_TARGET) out.txt

run_p: 
	./$(PARALLEL_TARGET) out.txt

clean:
	rm -f $(STANDARD_TARGET) $(PARALLEL_TARGET) out.txt

# export OMP_NUM_THREADS=
