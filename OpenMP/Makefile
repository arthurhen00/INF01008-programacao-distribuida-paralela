CXX = g++
CXXFLAGS = -std=c++17 -O2 -Wall

SRC_DIR = src
DATA_DIR = data

STANDARD_SRCS = $(SRC_DIR)/main.cpp
STANDARD_HEADERS = $(SRC_DIR)/state.h $(SRC_DIR)/sim_anneal.h
STANDARD_TARGET = sim_anneal

PARALLEL_SRCS = $(SRC_DIR)/main.cpp
PARALLEL_HEADERS = $(SRC_DIR)/state.h $(SRC_DIR)/sim_anneal_parallel.h
PARALLEL_TARGET = sim_anneal_parallel

GENERATOR_SRC = $(SRC_DIR)/$(DATA_DIR)/super_generator_2000.cpp
GENERATOR_TARGET = super_generator_2000

all: $(STANDARD_TARGET) $(PARALLEL_TARGET)

$(STANDARD_TARGET): $(STANDARD_SRCS) $(STANDARD_HEADERS)
	$(CXX) $(CXXFLAGS) $(STANDARD_SRCS) -o $(STANDARD_TARGET)

$(PARALLEL_TARGET): $(PARALLEL_SRCS) $(PARALLEL_HEADERS)
	$(CXX) $(CXXFLAGS) -fopenmp $(PARALLEL_SRCS) -o $(PARALLEL_TARGET)

$(GENERATOR_TARGET): $(GENERATOR_SRC)
	$(CXX) $(CXXFLAGS) $(GENERATOR_SRC) -o $(GENERATOR_TARGET)

generate: $(GENERATOR_TARGET)
	./$(GENERATOR_TARGET)

run: $(STANDARD_TARGET)
	./$(STANDARD_TARGET) 100000 0.998 921 points.txt

run_p: $(PARALLEL_TARGET)
	./$(PARALLEL_TARGET) 100000 0.998 921 points.txt

clean:
	rm -f $(STANDARD_TARGET) $(PARALLEL_TARGET) $(GENERATOR_TARGET) points.txt
